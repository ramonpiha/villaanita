---
import { getEntry } from 'astro:content';
import Layout from "../../components/Layout.astro";
import GalleryClient from "../../components/GalleryClient.js";

type Lang = "en" | "it" | "de";
type Property = {
  id: string;
  type: string;
  title: string;
  summary: string;
  coordinates: [number, number];
  images: string[];
};

export function getStaticPaths() {
  return [
    { params: { lang: "en" } },
    { params: { lang: "it" } },
    { params: { lang: "de" } },
  ];
}


const { lang } = Astro.params as { lang: Lang };
const title = "Rooms";

const propertiesEntry = await getEntry(`${lang}-properties`, 'properties');
const properties = propertiesEntry?.data || [];

// Filter for rooms and get all their images
const roomImages = properties
  .filter((prop: Property) => prop.type === 'room')    // Find only 'room' items
  .flatMap((room: Property) => room.images);          // Get all images from all rooms
---

<Layout lang={lang} title={title}>
  <h1 class="text-4xl md:text-5xl font-serif font-bold text-brand mb-6">
    Our Rooms
  </h1>
  <p class="text-lg text-brand/90 max-w-2xl mb-8">
    Browse our collection of traditional and cozy mountain rooms. 
    Each one offers a unique and comfortable stay.
  </p>
  {roomImages.length > 0 ? (
    <GalleryClient client:only="react" images={roomImages} />
  ) : (
    <p class="text-brand/70">No room images are available at this time.</p>
  )}
</Layout>