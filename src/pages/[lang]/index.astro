---
import { getCollection, getEntry } from 'astro:content';
import Layout from "../../components/Layout.astro";
import MapClient from "../../components/MapClient.js";
import AutoDetect from "../../components/AutoDetectLang.astro";

type Lang = "en" | "it" | "de";

export async function getStaticPaths() {
  return [
    { params: { lang: "en" } },
    { params: { lang: "it" } },
    { params: { lang: "de" } },
  ];
}

const { lang } = Astro.params as { lang: Lang };

// Get the home page content
const homeEntry = await getEntry(`${lang}-pages`, 'home');

// Get properties data
const propertiesEntry = await getEntry(`${lang}-properties`, 'properties');

const title = homeEntry.data.title;
const heading = homeEntry.data.heading;
const subheading = homeEntry.data.subheading;
const properties = propertiesEntry.data;
---

<Layout lang={lang} title={title}>
  <AutoDetect />
  
  <h1 class="text-4xl md:text-5xl font-serif font-bold text-charcoal mb-4">
    {heading}
  </h1>
  <p class="text-lg text-charcoal/90 mb-8 max-w-2xl">
    {subheading}
  </p>
  <div class="rounded-lg overflow-hidden shadow-lg my-8">
    <MapClient client:only="react" locations={properties} />
  </div>
</Layout>